# 数値解析手法

## ランダムウォーク

・$N$ステップごとの原点からの距離$R$、衝突までの移動距離$r$に対して、$R^2\sim Nr^2$

---

## 微分

##### 前進差分 
$$\frac{dy}{dt}_{c}=\frac{y(t+h)-y(t)}{h}$$

・$\frac{dy}{dt}_{c}=y'(t)+\frac{1}{2}hy''(t)+O(h^2)$

---

##### 中心差分 
$$\frac{dy}{dt}_{c}=\frac{y(t+h/2)-f(t-h/2)}{h}$$

・$\frac{dy}{dt}_{c}=y'(t)+\frac{1}{24}h^2y'''(t)+O(h^4)$

    ・ノイズが大きいと逆に精度が落ちる

---

##### 二階微分 
$$\frac{d^2 y}{dy^2}_C=\frac{y(t+h)+y(t-h)-2y(t)}{h^2}$$

    ・中心差分を2回用いた

---

## 積分

    ・積分区間が特異点を含むときは、取り除く必要がある

→$h=\frac{b-a}{N-1},\ x_i=a+ih$で与えられる

---

##### 台形則 
$$\int fdx\sim\frac{1}{2}h(f_0+f_{N-1})+h(f_2+...+f_{N-2})$$

    ・i=0,...,N-1
---

##### シンプソン則（二次関数近似）
$$w=\left(\frac{h}{3},\frac{4h}{3},\frac{2h}{3},\frac{4h}{3},...,\frac{4h}{3},\frac{h}{3}\right)$$

    ・f(x_i-h),f(x_i),f(x_i+h)を通るとしている
    
→$N$：奇数
→$\sum w_i=(N-1)h$

    ・Nは1000以下の方がよい

---

##### ガウス求積法

---

##### モンテカルロ法：
$$\int fdx\sim\frac{b-a}{N}\sum f(x_i)$$

    ・積分の第一平均値定理
    ・x_iはランダムに与える
    
→$\sigma_I\sim\frac{1}{\sqrt{N}}\sigma_f$

→多次元モンテカルロ法：
$$\int_A fdx\sim\frac{v(A)}{N}\sum f(x_i)$$

---

##### 分散低減法

    ・分散が大きい被積分関数を、より分散が小さな別の関数に変える

---

## 行列計算

#### 連立方程式

##### ガウス消去法（掃き出し法？）

    ・速い
    ・桁落ち、非ゼロ項の発生、計算に向かない

---

##### ヤコビ反復法

    ・計算向き

---

#### LU分解

---

#### QR分解

---

#### コレスキー分解

    ・linalg.cholesky(A)

---

#### 特異値分解

    ・linalg.svd(A)

---

#### 条件数

    ・linalg.cond(x)

---

#### 最小二乗解

    ・linalg.lstsq(a,b)

---

#### ムーア-ペンローズの疑似逆行列

---

## 解の探索

##### 二分法

    ・連続関数かつ、端点で符号が逆f(a)f(b)<0
    ・別に端の正負はどっちが正でもいい

・中間値の定理を満たすような点を、区間を狭くしていくことで探す

##### ニュートンラフソン法

    ・別に導関数が分かってなくても実行可能
    ・微分値が0なら推測値を変えてやり直し

・初期値から接線を引いて行って、$x$軸との交点を新たに探索値とする

・バックトラッキング？？？

    ・ステップサイズを調整

---

## 補完

    ・大域的に行うのは良くない

##### ラグランジュ補間
$$\Lambda(x)=(g,\lambda(x)),\ \lambda_i=\Pi_{j=1,j\neq i}^n\frac{x-x_j}{x_i-x_j}$$

    ・データ外にまで拡張することは良くない

→区間$I$において離散的な（$1\sim n$）ベクトル$a$とその点におけるデータ$g(a)$が与えられているときの、各$a$において$g(a)$を通るような$n-1$次多項式

・区間内にある$\zeta$が存在して、
$$f(x)-\Lambda(x)=\frac{(x-a_1)...(x-a_n)}{n!}f^{(n)}(\zeta)$$
が成り立つ

---

##### 三次スプライン補間

    ・見た目がよい

・いたるところ微分可能

    ・微分して力を求めるとかもできる

・積分：
$$\int_{x_i}^{x_k}g(x)dx=\sum_{i=j}^{k-1}\left(g_i(x_{i+1}-x_i)+\frac{1}{2}g_i'(x_{i+1}-x_i)^2+\frac{1}{6}g_i''(x_{i+1}-x_i)^3+\frac{1}{24}g_i'''(x_{i+1}-x_i)^4\right)$$

    ・全部xにして、[]_{x_i}^{x_{i+1}}してもよい？

---

##### 最小二乗法

・理論のパラメータ\ $(a_1,...,a_m)$ と独立変数$\ x$ からなる式$\ g(x,a)$ を決定する

    ・パラメータの値をデータから決定する

・カイ二乗
$\chi^2$

    ・σ：誤差

→解くべき方程式

    ・σ=1としてもよい

---

・一次式のフィッティング

    ・線形回帰

---

・二次式のフィッテイング

---

## フラクタルとランダム成長モデル


