# 凸解析

##### 凸集合と凸関数

##### 凸関数$f(\lambda a+(1-\lambda)b)\ge\lambda f(a)+(1-\lambda)f(b)$

・$f$が凸$\iff -f$が上に凸

・$f$が狭義単調増加な凸関数ならば、$f^{-1}$は狭義単調増加で上に凸

・$I$の内点で連続で、$I$から高々可算個の点を除いた$I^*$上で$C^1$

・任意の$I$の内点で、$D^{\pm}_xf(x)=f'(x\pm0)$

・任意の$I$の内点で、$f'(x-0)\le f'(x+0)$

    ・上に凸なら反転

・任意の$I$の内点で、$a<b$ならば$f'(a+0)\le f'(b-0)$

    ・上に凸なら反転

・任意の$x_0$に対して、$f'(x_0-0)\le\alpha\le f'(x_0+0)$を満たす$\alpha$を取ると、$f(x)\ge f(x_0)+\alpha(x-x_0)$

    ・fが微分可能な点においてはα=f'(x_0)とできる
    ・上に凸なら反転
    ・α=0と取れれば、fはx_0で最小値を取る

・任意の$I$の内点で、$f'(x-0),f'(x+0)$は単調増加、特に$I^*$上で$f'(x)$は単調増加

    ・上に凸なら反転

・$f'(x_0)=0$ならば、$f$は$x_0$において最小値を取る

    ・上に凸なら最大値

##### 凸性と同値な命題

・$f$が$2$回微分可能ならば、$f$が凸$\iff I$ 上 $f''(x)\ge0$

・$f$が凸$\iff f$が連続、$I$から高々可算個の点を除いた集合$I^*$上で$C^1$、$f'(x)$は$I^*$上単調減少

・$f$が凸$\iff f(a_1x_1+...+a_nx_n)\ge a_1f(x_1)+...+a_nf(x_n),\ \sum a_i=1$

・$f$が凸$\iff\forall y_1<y_2<y_3$に対して$(y_3-y_2)f(y_1)-(y_3-y_1)f(y_2)+(y_2-y_1)f(y_3)\ge0$

---

##### 凸集合 $x,y\in S,0\le\lambda\le1\Rightarrow\lambda x+(1-\lambda)y\in S$

・性質

    ・凸集合は穴の開いていない集合
    ・凸集合の共通部分は凸集合（有限、可算、非可算）

・錐$x\in S,\lambda>0\Rightarrow\lambda x\in S$
・凸錐$\iff x,y\in S,\lambda,\mu>0\Rightarrow\lambda x+\mu y\in S$

・凸多面体 $S=\{x\in\bm{R}^n\ |\ (Ax)_i\le b_i\}$

    ・b=0なら凸錐

・凸結合 $\sum\lambda_ix_i\ (\sum\lambda_i=1,x_i\in S)$

    ・Sが凸集合ならば、Sの任意の凸結合はSに属する

・$S$の凸包：$S$を含むすべての凸集合の共通部分$=S$の凸結合全体

・標示関数$\delta_S:\bm{R}^n\to\bm{R}\cup\{\infty\},\ \delta_S(x)=(0\ (x\in S),\infty\ (x\notin S))$

    ・Sが凸集合⇔δ_Sが凸関数

・エピグラフ $\mathrm{epi}f=\{(x,Y)\in\bm{R}^{n+1}\ |\ Y\ge f(x)\}$

    ・fが凸関数⇔epi fは凸集合

---

##### 凸集合の位相

・凸集合$S$の位相：$S$を含むアフィン包aff$S$から誘導される位相

    ・S^i=ri S
    ・実変数なら通常の位相

---

##### 多変数凸関数 $f:\bm{R}^n\supset X\to\bm{R}\cup\{\infty\},\ f(\lambda a+(1-\lambda)b)\ge\lambda f(a)+(1-\lambda)f(b),\ X$は凸集合

・凸関数の和は凸関数

    ・上に凸でも成り立つ

・凸関数の非負実数倍は凸関数

    ・上に凸でも成り立つ。負なら凹凸入れ替わる

・凸関数$f$に対して、$A\in M(n,\bm{R}),b\in\bm{R}$において$f(Ax+b)$は凸関数

    ・上に凸でも成り立つ
    ・合成はそんなに心配しなくてよい、どうせImは凸っぽくなる
    ・g(x)=f(X-x)も凸


・凸関数の族に対して、$\sup f_j$は凸関数（有限、可算、非可算）

    ・有限または無限個の一次関数の最大値として書かれる関数は凸関数
    ・下に凸ならinfで成り立つ

・多変数について凸ならば、各変数について凸

    ・k変数でも凸
    ・各変数に対してルジャンドル変換を実行できる

・凸関数$f$に対して、$f(y)=f(y\bm{x}_1+(1-y)\bm{x}_2)$は凸関数

    ・各変数のやつはこれの特別な場合



##### 凸性と同値な命題

・$f$が二階微分可能ならば、$f$が上に凸$\iff I$ 上 $(\frac{\partial^2f}{\partial x_i\partial x_j})$が半正定値

##### 凸関数の性質

・凸関数は連続

・凸関数$f$に対して、$\mathrm{grad}f(x_0)=0$ならば、$f$は$x_0$において最小値を取る

    ・上に凸なら最大値

##### 具体例

・任意の直線は上に凸かつ下に凸、定数でもよい

・二次関数$f(x)=\frac{1}{2}xA^Tx\ (A{は対称行列})$

    ・fが凸⇔Aが半正定値
    ・fが狭義凸⇔Aが正定値

---

##### ルジャンドル変換

・関数$f$に対する最小値集合$\arg\min f=\{x\in\bm{R}^n\ |\ f(x)\le f(y),\ \forall y\in S\}$

    ・fが凸ならargmin fは凸集合

・関数$f$、ベクトル$p$に対する$f[-p](x)=f(x)-(p,x)$

    ・fが凸関数ならばf[-p]も凸関数

・劣微分$\partial_{\bm{R}}f(x)=\{p\in\bm{R}^n\ |\ f[-p](y)\ge f[-p](x),\forall y\in S\}$
・$p\in\partial_{\bm{R}}f(x)\iff x\in\arg\min f[-p]$

    ・劣微分は凸集合
    ・xがdom fの内点ならば空でない
    ・fが凸関数かつxで微分可能ならば、p=∇fとして一意的

・

---